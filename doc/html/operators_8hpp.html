<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>EGS - Extended Gray-Scott Model simulation package: include/operators.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EGS - Extended Gray-Scott Model simulation package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">operators.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;gsl/gsl_rng.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_randist.h&gt;</code><br/>
</div>
<p><a href="operators_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a59f848f0879ce4a2889074e0b6d482bc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#a59f848f0879ce4a2889074e0b6d482bc">laplacian5_per_grid</a> (double **u, int i, int j, int M, int N, float hsq)</td></tr>
<tr class="separator:a59f848f0879ce4a2889074e0b6d482bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa62c41028a94d55f531cdbb96503e36"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#afa62c41028a94d55f531cdbb96503e36">laplacian5_per_grid</a> (double **u, int i, int j, int N, float hsq)</td></tr>
<tr class="separator:afa62c41028a94d55f531cdbb96503e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf8c2f9f3ddd4fff526bd6bd034c610c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#acf8c2f9f3ddd4fff526bd6bd034c610c">laplacian9_per</a> (double **u, int i, int j, int M, int N, float hsq)</td></tr>
<tr class="separator:acf8c2f9f3ddd4fff526bd6bd034c610c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72e9a3ef9e3f23880ff0f64f3de6be9d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#a72e9a3ef9e3f23880ff0f64f3de6be9d">gauss_noise</a> (double target, float cell_cap_1D, float noise_stddev, float level, gsl_rng *rgen)</td></tr>
<tr class="separator:a72e9a3ef9e3f23880ff0f64f3de6be9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c03a22f4f744daaa2a211bc3042aa94"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#a6c03a22f4f744daaa2a211bc3042aa94">unif_lin_noise</a> (double target, double level)</td></tr>
<tr class="separator:a6c03a22f4f744daaa2a211bc3042aa94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb24b0127f1ed4c97f88077630b794e"><td class="memTemplParams" colspan="2">template&lt;typename NumericType &gt; </td></tr>
<tr class="memitem:aecb24b0127f1ed4c97f88077630b794e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#aecb24b0127f1ed4c97f88077630b794e">set_concentration</a> (NumericType **a, NumericType conc, int xlo, int ylo, int xhi, int yhi, int nrows, int ncols)</td></tr>
<tr class="separator:aecb24b0127f1ed4c97f88077630b794e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997f4777b8b668d6b3b7d5f9cb6c6d5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#a997f4777b8b668d6b3b7d5f9cb6c6d5c">clone_values</a> (double **src, double **dest, int nrows, int ncols)</td></tr>
<tr class="separator:a997f4777b8b668d6b3b7d5f9cb6c6d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cbbd3792358af15f053b94dcb4ed68a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#a6cbbd3792358af15f053b94dcb4ed68a">total_conc</a> (double **mat, int nrows, int ncols)</td></tr>
<tr class="separator:a6cbbd3792358af15f053b94dcb4ed68a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357c82dddac97252c018fec8332babf0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#a357c82dddac97252c018fec8332babf0">get_mutation_coords</a> (char mscheme, double **v, int xlo, int xhi, int ylo, int yhi)</td></tr>
<tr class="separator:a357c82dddac97252c018fec8332babf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa376cd71c2701770143819f09001d61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="operators_8hpp.html#afa376cd71c2701770143819f09001d61">mutation_event</a> (double **wt, double **mut, int M, int N, float mfract, int msize, char mscheme, bool m_internal)</td></tr>
<tr class="separator:afa376cd71c2701770143819f09001d61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This header contains the implementations of "operators" (term very loosely defined), which are used in the evolution rules of the RD system or to modify the system state in some way. </p>

<p>Definition in file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a997f4777b8b668d6b3b7d5f9cb6c6d5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clone_values </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy concentrations from one matrix to the other (replacing previous values) The caller should check destination matrix dimensions to be no greater than the source.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>Source matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows,ncols</td><td>Source matrix size </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dest</td><td>Destination matrix, which should be smaller or equal to the source. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00296">296</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a72e9a3ef9e3f23880ff0f64f3de6be9d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double gauss_noise </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>cell_cap_1D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>noise_stddev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_rng *&#160;</td>
          <td class="paramname"><em>rgen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gaussian noise with sigma = noise_level * sqrt(target_value) and mean = 0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>Base value of the concentration to perturb with noise </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_cap</td><td>Square root of grid cell particle capacity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noise_var</td><td>Variance of gaussian noise </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>Noise level present in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rgen</td><td>GSL random number generator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Amount of noise </dd></dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00218">218</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a357c82dddac97252c018fec8332babf0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; get_mutation_coords </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>mscheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ylo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>yhi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the coordinates at which a mutation event should take place, given scheme and bounds. Not an operator in the sense of this file, but seems like the best place to put it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mscheme</td><td>The mutation scheme </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>The data matrix of the species underogoing mutation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlo,xhi,ylo,yhi</td><td>Inclusive bounds in which to place event </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LOWLIM</td><td>The effective null concentration (passed since def'd in main file) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Coordinates as a vector&lt;int&gt; of 2 elements </dd></dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00339">339</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a59f848f0879ce4a2889074e0b6d482bc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double laplacian5_per_grid </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>hsq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Discrete Laplacian with 5-point method and periodic boundaries.</p>
<p>Note on implementation: Boundary tests done explicitly (not with modulos) for speed since this is the simulation bottleneck (profiled). The code is cumbersome but faster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Concentration matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i,j</td><td>Grid coordinates, i: M, j:N </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">M,N</td><td>Matrix size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsq</td><td>Spatial discretisation step squared <img class="formulaInl" alt="$ h^2 = {\Delta x}^2 = \frac{L}{N}^2 $" src="form_4.png"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Laplacian approximation </dd></dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00050">50</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="afa62c41028a94d55f531cdbb96503e36"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double laplacian5_per_grid </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>hsq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Discrete Laplacian with 5-point method and periodic boundaries: square matrix version</p>
<p>The square matrix case was defined as a separate function as an optimization to reduce the overhead of a redundant argument.</p>
<p>Note on implementation: Boundary tests done explicitly (not with modulos) for speed since this is the simulation bottleneck (profiled). The code is cumbersome but faster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Concentration matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i,j</td><td>Grid coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Matrix size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsq</td><td>Spatial discretisation step squared <img class="formulaInl" alt="$ h^2 = {\Delta x}^2 = \frac{L}{N}^2 $" src="form_4.png"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Laplacian approximation </dd></dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00101">101</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="acf8c2f9f3ddd4fff526bd6bd034c610c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double laplacian9_per </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>hsq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Discrete Laplacian with 9-point method and periodic boundaries.</p>
<p>Note on implementation: Boundary tests done explicitly (not with modulos) for speed since this is the simulation bottleneck (profiled). The code is cumbersome but faster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Concentration matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i,j</td><td>Grid coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">M,N</td><td>Matrix size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsq</td><td>Spatial discretisation step squared <img class="formulaInl" alt="$ h^2 = {\Delta x}^2 = \frac{L}{N}^2 $" src="form_4.png"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Laplacian approximation </dd></dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00149">149</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="afa376cd71c2701770143819f09001d61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutation_event </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>wt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>mut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>mfract</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>msize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>mscheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>m_internal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Introduces a mutant "drop" of given parameters into the system at certain coordinates, according to given scheme.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">wt</td><td>Wild type species concentration matrix, upon which the mutant parameters are based </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mut</td><td>Mutant species concentration matrix, into which the drop is placed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">M,N</td><td>Size of the concentration matrices </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mfract</td><td>Concentration of mutant drop or fraction of converted wild type, based on </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">m_internal</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msize</td><td>The size (Moore radius) of the mutant drop to place </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mscheme</td><td>Way in which to place the drop (M = at maximum peak of wild type, m = at a minimum of wt, r = random) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m_internal</td><td>"Internal" mutation: convert </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mfract</td><td>of the wild type to mutant </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00405">405</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aecb24b0127f1ed4c97f88077630b794e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename NumericType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void set_concentration </td>
          <td>(</td>
          <td class="paramtype">NumericType **&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NumericType&#160;</td>
          <td class="paramname"><em>conc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ylo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>yhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the concentration of a given area to a given value. Any invalid parameters leave the matrix unaltered.</p>
<p>Notes:</p>
<ol type="1">
<li>The limits are virtual coordinates that go beyond array bounds (e.g. (-32, ncols+100)) and which wrap around while looping over area. This approach is for long wrap-arounds that cause ambiguity in resulting area to be set.</li>
<li>As long as type(a) == type(conc), any data type could be passed.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">a</td><td>The concentration matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">conc</td><td>The concentration to set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlo,ylo</td><td>Lower corner of area to set (inclusive); x: matix lines, y: columns </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xhi,yhi</td><td>Higher corner of area to set (inclusive); x: matix lines, y: columns </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows,ncols</td><td>Size of matrix (rows, columns) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00266">266</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6cbbd3792358af15f053b94dcb4ed68a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double total_conc </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns total concentration. Written for convenience.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>Cocentration matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows,ncols</td><td>Matrix size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Total concentration (simple sum) </dd></dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00311">311</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6c03a22f4f744daaa2a211bc3042aa94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double unif_lin_noise </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Uniform linear noise in the range (-target*level, +target*level) (uniform: range as function of target)</p>
<p>Note: used for some tests but rand() is not to be trusted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>&gt;=0 Base value of the concentration to perturb with noise </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>&gt;=0 Noise level present in the system </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Amount of noise </dd></dl>

<p>Definition at line <a class="el" href="operators_8hpp_source.html#l00235">235</a> of file <a class="el" href="operators_8hpp_source.html">operators.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 24 2014 14:14:47 for EGS - Extended Gray-Scott Model simulation package by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
